<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Medi-Solutions Retirement Budget Planner</title>

<style>
  :root{
    --blue:#1f2a75;
    --bg:#f4f6fa;
    --card:#fff;
    --line:#e0e4ef;
    --muted:#6b7280;
    --good:#0a7a3b;
    --bad:#c62828;
  }
  *{ box-sizing:border-box; }
  body{ margin:0; font-family:Arial, Helvetica, sans-serif; background:var(--bg); color:#1a1f36; }
  .container{
    max-width: 980px;
    margin: 18px auto;
    background: var(--card);
    padding: 14px;
    border-radius: 12px;
    box-shadow: 0 8px 22px rgba(0,0,0,.08);
  }

  header{ text-align:center; margin-bottom: 10px; }
  .logo{
    width: min(900px, 100%);
    height:auto;
    display:block;
    margin: 0 auto 8px;
  }
  .logo-hint{
    display:none;
    margin: 8px auto 0;
    max-width: 860px;
    background:#fff4f4;
    border:1px solid #ffd2d2;
    color:#8b1a1a;
    padding:10px;
    border-radius:10px;
    font-size:12px;
    text-align:left;
  }
  h1{ margin: 0; font-size: 20px; color:var(--blue); }
  .subtitle{ margin: 4px 0 0; color:var(--muted); font-size: 12px; }

  /* compact controls bar */
  .bar{
    display:grid;
    grid-template-columns: 1.2fr .8fr .6fr;
    gap:10px;
    border:1px solid var(--line);
    border-radius:12px;
    padding:10px;
    background:#fbfcff;
    margin: 10px 0 12px;
  }
  @media (max-width: 820px){
    .bar{ grid-template-columns: 1fr; }
  }

  label{ display:block; font-size:11px; color:var(--muted); margin-bottom:4px; }
  input[type="text"], input[type="number"], input[type="date"], select{
    width:100%;
    padding: 8px 9px;
    border-radius:10px;
    border:1px solid #cfd5e6;
    font-size:13px;
    background:#fff;
    outline:none;
  }

  .bar .block{ display:flex; flex-direction:column; gap:8px; }
  .row2{ display:grid; grid-template-columns: 1fr 1fr; gap:8px; }
  @media (max-width: 520px){ .row2{ grid-template-columns: 1fr; } }

  details{
    border:1px solid var(--line);
    border-radius:12px;
    background:#fbfcff;
    margin: 10px 0;
    overflow:hidden;
  }
  summary{
    cursor:pointer;
    padding: 10px 12px;
    list-style:none;
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
    font-weight:700;
    color:var(--blue);
    user-select:none;
  }
  summary::-webkit-details-marker{ display:none; }
  .sumtag{ font-weight:600; font-size:12px; color:var(--muted); }

  .section-body{ padding: 10px 12px 12px; border-top:1px solid var(--line); }

  .list{ display:flex; flex-direction:column; gap:10px; }
  .item{
    border:1px solid var(--line);
    border-radius:12px;
    background:#fff;
    padding:10px;
  }
  .item .item-actions{ display:flex; justify-content:flex-end; margin-top:8px; }

  .btn-row{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
  .btn{
    padding:8px 10px;
    border:none;
    border-radius:10px;
    cursor:pointer;
    font-size:12px;
  }
  .btn.primary{ background:var(--blue); color:#fff; }
  .btn.primary:hover{ background:#15205a; }
  .btn.secondary{ background:#e9ecf7; color:var(--blue); border:1px solid #cfd5e6; }
  .btn.secondary:hover{ background:#dde3fb; }
  .btn.danger{ background:#ffe9e9; color:#8b1a1a; border:1px solid #ffcccc; }
  .btn.danger:hover{ background:#ffdcdc; }

  .summary{
    margin-top: 10px;
    padding: 10px 12px;
    border-radius:12px;
    background:#eef2ff;
    border:1px solid #d6dcff;
  }
  .summary .r{ display:flex; justify-content:space-between; gap:10px; padding:5px 0; font-size:14px; }
  .summary strong{ color:var(--blue); }
  .net{ font-weight:800; }
  .net.positive{ color:var(--good); }
  .net.negative{ color:var(--bad); }

  .note{ margin-top:10px; font-size:11px; color:#555; line-height:1.35; }

  /* print header */
  .print-header{ display:none; margin-bottom:10px; padding-bottom:8px; border-bottom:2px solid #000; }
  .print-header h2{ margin:0; font-size:16px; }
  .print-header .meta{ margin-top:6px; font-size:12px; }

  @media print{
    body{ background:#fff; }
    .container{ box-shadow:none; margin:0; border-radius:0; }
    .btn-row, .bar{ display:none !important; }
    .print-header{ display:block; }
    details{ border:1px solid #bbb; }
    .summary{ background:#fff; border:1px solid #bbb; }
    .logo-hint{ display:none !important; }
  }
</style>
</head>

<body>
  <div class="container">

    <div class="print-header">
      <h2>Medi-Solutions Retirement Income & Expense Planner</h2>
      <div class="meta">
        <div><strong>Client:</strong> <span id="printClientName">—</span></div>
        <div><strong>Date:</strong> <span id="printDate">—</span></div>
        <div><strong>View:</strong> <span id="printMode">Monthly</span></div>
      </div>
    </div>

    <header>
      <img
        class="logo"
        src="./medi-solutions-logo.png"
        alt="Medi-Solutions Insurance Agency, LLC Logo"
        onerror="document.getElementById('logoHint').style.display='block';"
      />
      <div id="logoHint" class="logo-hint">
        <strong>Logo not loading.</strong><br>
        Fix: make sure the image file is in the SAME folder as <code>index.html</code> and named exactly
        <code>medi-solutions-logo.png</code> (lowercase, no extra spaces). GitHub Pages is case-sensitive.
      </div>

      <h1>Retirement Income & Expense Planner</h1>
      <p class="subtitle">Auto-calculations • Monthly/Annual toggle • Includes IRMAA, travel, and family cushion</p>
    </header>

    <!-- compact controls -->
    <div class="bar">
      <div class="block">
        <div class="row2">
          <div>
            <label for="clientName">Client Name</label>
            <input id="clientName" type="text" placeholder="Client name" />
          </div>
          <div>
            <label for="planDate">Plan Date</label>
            <input id="planDate" type="date" />
          </div>
        </div>
        <div>
          <label for="clientNotes">Notes (optional)</label>
          <input id="clientNotes" type="text" placeholder="Trips, family help, big projects, etc." />
        </div>
      </div>

      <div class="block">
        <div>
          <label for="mode">View</label>
          <select id="mode">
            <option value="monthly" selected>Monthly</option>
            <option value="annual">Annual</option>
          </select>
        </div>
        <div>
          <label for="cushionPct">Emergency cushion (% of expenses)</label>
          <input id="cushionPct" type="number" step="0.5" min="0" max="50" value="0" />
        </div>
      </div>

      <div class="block">
        <div class="btn-row" style="margin-top:18px;">
          <button class="btn secondary" type="button" id="resetBtn">Reset</button>
          <button class="btn secondary" type="button" id="printBtn">Print/PDF</button>
        </div>
        <div class="note" style="margin-top:6px;">
          Values are per <span id="periodWord">month</span>.
        </div>
      </div>
    </div>

    <!-- INCOME -->
    <details open>
      <summary>
        <span>Money In (<span id="modeLabelIn">Monthly</span>)</span>
        <span class="sumtag">Add income sources</span>
      </summary>
      <div class="section-body">
        <div id="incomeList" class="list"></div>
        <div class="btn-row">
          <button class="btn primary" type="button" id="addIncomeBtn">+ Add Income</button>
        </div>
      </div>
    </details>

    <!-- EXPENSES -->
    <details open>
      <summary>
        <span>Money Out (<span id="modeLabelOut">Monthly</span>)</span>
        <span class="sumtag">Includes IRMAA, travel, family cushion</span>
      </summary>
      <div class="section-body">
        <div id="expenseList" class="list"></div>

        <!-- Auto cushion -->
        <div class="item" style="border-style:dashed;">
          <label>Auto Expense Line</label>
          <div style="font-weight:700; color:var(--blue); margin-bottom:6px;">
            Emergency Cushion (<span id="cushionLabelPct">0</span>%)
          </div>
          <label>Calculated Amount ($ per <span id="cushionPeriod">month</span>)</label>
          <input id="cushionAmount" type="number" value="0" readonly />
          <div class="note" style="margin-top:6px;">Included in Total Expenses automatically.</div>
        </div>

        <div class="btn-row">
          <button class="btn primary" type="button" id="addExpenseBtn">+ Add Expense</button>
        </div>
      </div>
    </details>

    <!-- SUMMARY -->
    <div class="summary">
      <div class="r"><span><strong>Total Income</strong></span><span>$<span id="totalIncome">0</span></span></div>
      <div class="r"><span><strong>Total Expenses</strong> <span style="color:var(--muted); font-size:11px;">(incl. cushion)</span></span><span>$<span id="totalExpense">0</span></span></div>
      <div class="r"><span><strong>Net Cash Flow</strong></span><span class="net" id="netResult">$0</span></div>
    </div>

    <div class="note">
      Planning tool only — not tax/legal advice. Medicare costs vary by plan/income. IRMAA depends on modified adjusted gross income.
    </div>
  </div>

<script>
  const fmt = new Intl.NumberFormat(undefined, { maximumFractionDigits: 0 });

  function toNumber(v){
    const n = Number(String(v ?? "").replace(/[^0-9.-]/g,""));
    return Number.isFinite(n) ? n : 0;
  }

  function getMode(){ return document.getElementById("mode").value; } // monthly|annual
  function periodLabel(){ return getMode() === "annual" ? "year" : "month"; }

  function setPeriodText(){
    const modeText = getMode() === "annual" ? "Annual" : "Monthly";
    document.getElementById("modeLabelIn").textContent = modeText;
    document.getElementById("modeLabelOut").textContent = modeText;
    document.getElementById("periodWord").textContent = periodLabel();
    document.getElementById("cushionPeriod").textContent = periodLabel();
  }

  function createStackedItem(container, labelValue, amountValue, onChange){
    const wrap = document.createElement("div");
    wrap.className = "item";

    const lbl1 = document.createElement("label");
    lbl1.textContent = "Item";

    const name = document.createElement("input");
    name.type = "text";
    name.value = labelValue || "";
    name.placeholder = "Enter item (example: Social Security, Pension, Travel...)";
    name.addEventListener("input", onChange);

    const lbl2 = document.createElement("label");
    lbl2.style.marginTop = "8px";
    lbl2.textContent = `Amount ($ per ${periodLabel()})`;

    const amt = document.createElement("input");
    amt.type = "number";
    amt.step = "1";
    amt.min = "0";
    amt.value = amountValue ?? 0;
    amt.addEventListener("input", onChange);

    const actions = document.createElement("div");
    actions.className = "item-actions";

    const removeBtn = document.createElement("button");
    removeBtn.type = "button";
    removeBtn.className = "btn danger";
    removeBtn.textContent = "Remove";
    removeBtn.addEventListener("click", () => { wrap.remove(); onChange(); });

    actions.appendChild(removeBtn);

    wrap.appendChild(lbl1);
    wrap.appendChild(name);
    wrap.appendChild(lbl2);
    wrap.appendChild(amt);
    wrap.appendChild(actions);

    container.appendChild(wrap);
  }

  function updateAmountLabels(){
    document.querySelectorAll('.item label').forEach(l => {
      if(l.textContent.startsWith("Amount ($ per ")){
        l.textContent = `Amount ($ per ${periodLabel()})`;
      }
    });
  }

  function sumList(listId){
    const list = document.getElementById(listId);
    let total = 0;
    list.querySelectorAll('.item input[type="number"]').forEach(inp => total += toNumber(inp.value));
    return total;
  }

  function calcCushion(baseExpenses){
    const pct = Math.max(0, Math.min(50, toNumber(document.getElementById("cushionPct").value)));
    document.getElementById("cushionLabelPct").textContent = pct;
    const cushion = baseExpenses * (pct / 100);
    document.getElementById("cushionAmount").value = Math.round(cushion);
    return cushion;
  }

  function calculate(){
    setPeriodText();

    const incomeTotal = sumList("incomeList");
    const expenseBase = sumList("expenseList");
    const cushion = calcCushion(expenseBase);
    const expenseTotal = expenseBase + cushion;
    const net = incomeTotal - expenseTotal;

    document.getElementById("totalIncome").textContent = fmt.format(incomeTotal);
    document.getElementById("totalExpense").textContent = fmt.format(expenseTotal);

    const netEl = document.getElementById("netResult");
    netEl.textContent = "$" + fmt.format(net);
    netEl.classList.remove("positive","negative");
    netEl.classList.add(net >= 0 ? "positive" : "negative");

    // print header bindings
    document.getElementById("printClientName").textContent = document.getElementById("clientName").value || "—";
    document.getElementById("printDate").textContent = document.getElementById("planDate").value || "—";
    document.getElementById("printMode").textContent = (getMode() === "annual" ? "Annual" : "Monthly");
  }

  function convertAllAmounts(factor){
    ["incomeList","expenseList"].forEach(listId => {
      document.getElementById(listId)
        .querySelectorAll('.item input[type="number"]')
        .forEach(inp => inp.value = Math.round(toNumber(inp.value) * factor));
    });
  }

  function onModeChange(){
    const prev = window.__modePrev || "monthly";
    const next = getMode();
    if(prev === next){ calculate(); return; }

    const factor = (prev === "monthly" && next === "annual") ? 12 :
                   (prev === "annual" && next === "monthly") ? (1/12) : 1;

    convertAllAmounts(factor);
    updateAmountLabels();

    window.__modePrev = next;
    calculate();
  }

  function seedDefaults(){
    const incomeDefaults = [
      "Social Security (You)",
      "Social Security (Spouse)",
      "Pension Income",
      "Annuity Income",
      "Investment Withdrawals (RMD/IRA)",
      "Rental Income"
    ];

    const expenseDefaults = [
      "Housing (Mortgage/Rent/HOA)",
      "Utilities (Electric/Gas/Water/Internet)",
      "Groceries & Household",
      "Transportation (Fuel/Insurance/Maintenance)",
      "Medicare Premiums (Part B/Plan/Medigap/MA)",
      "IRMAA (Income Related Monthly Adjustment Amount)",
      "Out-of-Pocket Medical & Prescriptions",
      "Travel & Vacations",
      "Long-Term Care Planning / Caregiving",
      "Unforeseen Family Expenses (Cushion)"
    ];

    const incomeList = document.getElementById("incomeList");
    const expenseList = document.getElementById("expenseList");
    incomeList.innerHTML = "";
    expenseList.innerHTML = "";

    incomeDefaults.forEach(item => createStackedItem(incomeList, item, 0, calculate));
    expenseDefaults.forEach(item => createStackedItem(expenseList, item, 0, calculate));

    document.getElementById("cushionPct").value = 0;
    document.getElementById("clientName").value = "";
    document.getElementById("clientNotes").value = "";

    const d = new Date();
    const yyyy = d.getFullYear();
    const mm = String(d.getMonth()+1).padStart(2,"0");
    const dd = String(d.getDate()).padStart(2,"0");
    document.getElementById("planDate").value = `${yyyy}-${mm}-${dd}`;

    document.getElementById("mode").value = "monthly";
    window.__modePrev = "monthly";

    updateAmountLabels();
    calculate();
  }

  // events
  document.getElementById("addIncomeBtn").addEventListener("click", () => {
    createStackedItem(document.getElementById("incomeList"), "", 0, calculate);
    calculate();
  });
  document.getElementById("addExpenseBtn").addEventListener("click", () => {
    createStackedItem(document.getElementById("expenseList"), "", 0, calculate);
    calculate();
  });

  document.getElementById("mode").addEventListener("change", onModeChange);
  document.getElementById("cushionPct").addEventListener("input", calculate);
  document.getElementById("clientName").addEventListener("input", calculate);
  document.getElementById("planDate").addEventListener("change", calculate);

  document.getElementById("resetBtn").addEventListener("click", seedDefaults);
  document.getElementById("printBtn").addEventListener("click", () => window.print());

  // init
  seedDefaults();
</script>
</body>
</html>
